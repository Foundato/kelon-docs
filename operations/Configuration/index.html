
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-7.0.6">
    
    
      
        <title>Configuration - Kelon Docs</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.2c0c5eaf.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.7fa14f5b.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
      
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#configuration" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Kelon Docs" class="md-header__button md-logo" aria-label="Kelon Docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Kelon Docs
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Configuration
            
          </span>
        </div>
      </div>
    </div>
    <div class="md-header__options">
      
    </div>
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/foundato/kelon/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    foundato/kelon
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Kelon Docs" class="md-nav__button md-logo" aria-label="Kelon Docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    Kelon Docs
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/foundato/kelon/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    foundato/kelon
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1" type="checkbox" id="__nav_1" >
      
      <label class="md-nav__link" for="__nav_1">
        Core Docs
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Core Docs" data-md-level="1">
        <label class="md-nav__title" for="__nav_1">
          <span class="md-nav__icon md-icon"></span>
          Core Docs
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Introduction
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_2" type="checkbox" id="__nav_1_2" >
      
      <label class="md-nav__link" for="__nav_1_2">
        Overview
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Overview" data-md-level="2">
        <label class="md-nav__title" for="__nav_1_2">
          <span class="md-nav__icon md-icon"></span>
          Overview
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../core/overview/Simple-Example/" class="md-nav__link">
        Example
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../core/overview/example/Create-Policies/" class="md-nav__link">
        Create Policies
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../core/overview/example/Configure-Kelon/" class="md-nav__link">
        Configure Kelon
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../core/overview/example/Run-Example/" class="md-nav__link">
        Run the example
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_3" type="checkbox" id="__nav_1_3" >
      
      <label class="md-nav__link" for="__nav_1_3">
        Philosophy
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Philosophy" data-md-level="2">
        <label class="md-nav__title" for="__nav_1_3">
          <span class="md-nav__icon md-icon"></span>
          Philosophy
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../core/philosophy/Why-External-Policy-Enforcement/" class="md-nav__link">
        Why external Policy Enforcement
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../core/philosophy/What-Is-A-Policy/" class="md-nav__link">
        What is a Policy
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_4" type="checkbox" id="__nav_1_4" >
      
      <label class="md-nav__link" for="__nav_1_4">
        Architecture
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Architecture" data-md-level="2">
        <label class="md-nav__title" for="__nav_1_4">
          <span class="md-nav__icon md-icon"></span>
          Architecture
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../core/architecture/Components/" class="md-nav__link">
        Components
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../core/architecture/Policy-Translation/" class="md-nav__link">
        Policy Translation
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../core/architecture/Query-AST/" class="md-nav__link">
        Query-AST
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_5" type="checkbox" id="__nav_1_5" >
      
      <label class="md-nav__link" for="__nav_1_5">
        Integrating Kelon
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Integrating Kelon" data-md-level="2">
        <label class="md-nav__title" for="__nav_1_5">
          <span class="md-nav__icon md-icon"></span>
          Integrating Kelon
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../core/integration/Services-And-Kelon/" class="md-nav__link">
        Services and Kelon
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_6" type="checkbox" id="__nav_1_6" >
      
      <label class="md-nav__link" for="__nav_1_6">
        Extending Kelon
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Extending Kelon" data-md-level="2">
        <label class="md-nav__title" for="__nav_1_6">
          <span class="md-nav__icon md-icon"></span>
          Extending Kelon
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../core/extend/Write-Plugins/" class="md-nav__link">
        Writing plugins
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../core/extend/Write-Call-Operand-Mappings/" class="md-nav__link">
        Writing call-operand-mappings
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../core/extend/Write-Datastore-Plugin/" class="md-nav__link">
        Write a datasource plugin
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" checked>
      
      <label class="md-nav__link" for="__nav_2">
        Operations
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Operations" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Operations
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../APIs/" class="md-nav__link">
        APIs
      </a>
    </li>
  

          
            
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Configuration
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Configuration
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#kelon-cli" class="md-nav__link">
    Kelon (CLI)
  </a>
  
    <nav class="md-nav" aria-label="Kelon (CLI)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#general" class="md-nav__link">
    General
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#telemetry" class="md-nav__link">
    Telemetry
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datastoreyml" class="md-nav__link">
    datastore.yml
  </a>
  
    <nav class="md-nav" aria-label="datastore.yml">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#connection-options" class="md-nav__link">
    Connection options
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#injecting-environment-variables" class="md-nav__link">
    Injecting environment variables
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#call-operandsdatastore-typeyml" class="md-nav__link">
    call-operands/{datastore-type}.yml
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#apiyml" class="md-nav__link">
    api.yml
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#opayml" class="md-nav__link">
    opa.yml
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Deployment/" class="md-nav__link">
        Deployment
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Monitoring/" class="md-nav__link">
        Monitoring
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Security/" class="md-nav__link">
        Security
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Testing/" class="md-nav__link">
        Testing
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#kelon-cli" class="md-nav__link">
    Kelon (CLI)
  </a>
  
    <nav class="md-nav" aria-label="Kelon (CLI)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#general" class="md-nav__link">
    General
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#telemetry" class="md-nav__link">
    Telemetry
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datastoreyml" class="md-nav__link">
    datastore.yml
  </a>
  
    <nav class="md-nav" aria-label="datastore.yml">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#connection-options" class="md-nav__link">
    Connection options
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#injecting-environment-variables" class="md-nav__link">
    Injecting environment variables
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#call-operandsdatastore-typeyml" class="md-nav__link">
    call-operands/{datastore-type}.yml
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#apiyml" class="md-nav__link">
    api.yml
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#opayml" class="md-nav__link">
    opa.yml
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/foundato/kelon/edit/master/docs/operations/Configuration.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="configuration">Configuration</h1>
<h2 id="kelon-cli">Kelon (CLI)</h2>
<p>Kelon already comes with a CLI. Just type <code>kelon --help</code> after you installed it.
<div class="highlight"><pre><span></span><code>usage: kelon [&lt;flags&gt;] &lt;command&gt; [&lt;args&gt; ...]

Kelon policy enforcer.

Flags:
  -h, --help                   Show context-sensitive help (also try --help-long and --help-man).
  -d, --datastore-conf=./datastore.yml  
                               Path to the datastore configuration yaml.
  -a, --api-conf=./api.yml     Path to the api configuration yaml.
      --config-watcher-path=CONFIG-WATCHER-PATH  
                               Path where the config watcher should listen for changes.
  -o, --opa-conf=./opa.yml     Path to the OPA configuration yaml.
  -r, --rego-dir=REGO-DIR      Dir containing .rego files which will be loaded into OPA.
      --path-prefix=&quot;/v1&quot;      Prefix which is used to proxy OPA&#39;s Data-API.
  -p, --port=8181              Port on which the proxy endpoint is served.
      --preprocess-policies    Preprocess incoming policies for internal use-case (EXPERIMENTAL FEATURE! DO NOT USE!).
      --log-level=INFO         Log-Level for Kelon. Must be one of [DEBUG, INFO, WARN, ERROR]
      --access-decision-log-level=ALL
                               Configuration for logging access decisions while Info-Log-Level for Kelon. Must be one of [ALL, ALLOW, DENY, NONE]
      --respond-with-status-code  
                               Communicate Decision via status code 200 (ALLOW) or 403 (DENY).
      --telemetry-service=TELEMETRY-SERVICE  
                               Service that is used for telemetry [Prometheus]
      --version                Show application version.

Commands:
  help [&lt;command&gt;...]
    Show help.

  run
    Run kelon in production mode.
</code></pre></div></p>
<p>In addition to that Kelon provides the possibility to be configured via environment variables. This may be handy if you want to run it inside a container.</p>
<h3 id="general">General</h3>
<table>
<thead>
<tr>
<th>Flag</th>
<th>Short</th>
<th>Environment</th>
<th>Default</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>--datastore-conf</td>
<td>-d</td>
<td>DATASTORE_CONF</td>
<td>./datastore.yml</td>
<td>Existing File</td>
</tr>
<tr>
<td>--api-conf</td>
<td>-a</td>
<td>API_CONF</td>
<td>./api.yml</td>
<td>Existing File</td>
</tr>
<tr>
<td>--config-watcher-path</td>
<td></td>
<td>CONFIG_WATCHER_PATH</td>
<td>./policies</td>
<td>Existing Dir</td>
</tr>
<tr>
<td>--opa-conf</td>
<td>-o</td>
<td>OPA_CONF</td>
<td>./opa.yml</td>
<td>Existing File</td>
</tr>
<tr>
<td>--rego-dir</td>
<td>-r</td>
<td>REGO_DIR</td>
<td>./policies</td>
<td>Existing Dir</td>
</tr>
<tr>
<td>--path-prefix</td>
<td></td>
<td>PATH_PREFIX</td>
<td>/v1</td>
<td>String</td>
</tr>
<tr>
<td>--port</td>
<td>-p</td>
<td>PORT</td>
<td>8181</td>
<td>Number</td>
</tr>
<tr>
<td>--preprocess-policies</td>
<td></td>
<td>PREPROCESS_POLICIES</td>
<td>false</td>
<td>Boolean</td>
</tr>
<tr>
<td>--respond-with-status-code</td>
<td></td>
<td>RESPOND_WITH_STATUS_CODE</td>
<td>false</td>
<td>Boolean</td>
</tr>
<tr>
<td>--access-decision-log-level</td>
<td></td>
<td>ACCESS_DECISION_LOG_LEVEL</td>
<td>ALL</td>
<td>Enum</td>
</tr>
</tbody>
</table>
<h3 id="telemetry">Telemetry</h3>
<table>
<thead>
<tr>
<th>Flag</th>
<th>Short</th>
<th>Environment</th>
<th>Default</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>--telemetry-service</td>
<td></td>
<td>TELEMETRY_SERVICE</td>
<td></td>
<td>Enum</td>
</tr>
</tbody>
</table>
<h2 id="datastoreyml">datastore.yml</h2>
<p>The <code>datastore.yml</code> defines all available datastores and their entities.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># List of all datastores which kelon should be able to connect to</span>
<span class="c1"># Each datastore has to have an entity schema configured!</span>
<span class="nt">datastores</span><span class="p">:</span>

  <span class="c1"># Datastore&#39;s alias (it will be used throughout all your policies).</span>
  <span class="nt">mysql</span><span class="p">:</span>

    <span class="c1"># Datastore type</span>
    <span class="c1"># Kelon supports [mysql, postgres, mongo]</span>
    <span class="p p-Indicator">[</span><span class="nv">type</span><span class="p p-Indicator">:</span> <span class="nv">&lt;string&gt;</span><span class="p p-Indicator">]</span>

    <span class="c1"># Properties that are needed to connect to the datastore</span>
    <span class="nt">connection</span><span class="p">:</span>     

      <span class="c1"># Hostname or IP of the database</span>
      <span class="p p-Indicator">[</span><span class="nv">host</span><span class="p p-Indicator">:</span> <span class="nv">&lt;string&gt;</span><span class="p p-Indicator">]</span>

      <span class="c1"># Port under which the database is available</span>
      <span class="p p-Indicator">[</span><span class="nv">port</span><span class="p p-Indicator">:</span> <span class="nv">&lt;int&gt;</span><span class="p p-Indicator">]</span>

      <span class="c1"># Name of the database to connect to</span>
      <span class="c1"># Many database servers run multiple databases.</span>
      <span class="c1"># In this case create one datastore for each database</span>
      <span class="p p-Indicator">[</span><span class="nv">database</span><span class="p p-Indicator">:</span> <span class="nv">&lt;string&gt;</span><span class="p p-Indicator">]</span>

      <span class="c1"># The user which is used for the database connection</span>
      <span class="p p-Indicator">[</span><span class="nv">user</span><span class="p p-Indicator">:</span> <span class="nv">&lt;string&gt;</span><span class="p p-Indicator">]</span>

      <span class="c1"># The password of the user</span>
      <span class="p p-Indicator">[</span><span class="nv">password</span><span class="p p-Indicator">:</span> <span class="nv">&lt;string&gt;</span><span class="p p-Indicator">]</span>

      <span class="c1"># Connection options for the database connection</span>
      <span class="c1"># To get all available options for your database, see section &quot;Connection options&quot; below</span>
      <span class="p p-Indicator">[</span><span class="nv">&lt;option&gt;</span><span class="p p-Indicator">:</span> <span class="nv">&lt;string&gt;</span><span class="p p-Indicator">]</span>

    <span class="c1"># Metadata attached to the datastore</span>
    <span class="nt">metadata</span><span class="p">:</span>

      <span class="c1"># Only used from SQL-Datastores</span>
      <span class="c1"># Sets max idle connections of the database connection pool</span>

      <span class="p p-Indicator">[</span><span class="nv">maxIdleConnections</span><span class="p p-Indicator">:</span> <span class="nv">&lt;int&gt;</span><span class="p p-Indicator">]</span>

      <span class="c1"># Only used from SQL-Datastores</span>
      <span class="c1"># Sets max open connections of the database connection pool</span>
      <span class="p p-Indicator">[</span><span class="nv">maxOpenConnections</span><span class="p p-Indicator">:</span> <span class="nv">&lt;int&gt;</span><span class="p p-Indicator">]</span>

      <span class="c1"># Only used from SQL-Datastores</span>
      <span class="c1"># Sets max lifetime of each connection inside the database connection pool</span>
      <span class="p p-Indicator">[</span><span class="nv">connectionMaxLifetimeSeconds</span><span class="p p-Indicator">:</span> <span class="nv">&lt;int&gt;</span><span class="p p-Indicator">]</span>


<span class="c1"># Entity-Schemas define the entities of one schema inside a datastore.</span>
<span class="c1"># An entity_schema has several purposes:</span>
<span class="c1">#   =&gt; Help kelon to detect misspellings in regos</span>
<span class="c1">#   =&gt; Create entity-aliases for complex table-names</span>
<span class="c1">#   =&gt; Define the structure of nested entities (Just for No-SQL DBs)</span>
<span class="nt">entity_schemas</span><span class="p">:</span>

  <span class="c1"># Datastore&#39;s alias</span>
  <span class="c1"># This example shows how each SQL-Datastore should be configured.</span>
  <span class="nt">mysql</span><span class="p">:</span>

    <span class="c1"># Schema name</span>
    <span class="c1"># Kelon automatically adds the schema name to entities</span>
    <span class="c1"># This means that &#39;data.mysql.users&#39; inside a rego will be translated </span>
    <span class="c1"># to &#39;appstore.users&#39; in the resulting SQL-Statement.</span>
    <span class="c1">#</span>
    <span class="c1"># !!! The entities inside all schemas of one Datastore have to be disjunct !!!</span>
    <span class="c1"># Otherwise kelon will fail on startup</span>
    <span class="nt">appstore</span><span class="p">:</span>

      <span class="c1"># List of all entities of schema &#39;appstore&#39;</span>
      <span class="nt">entities</span><span class="p">:</span>

        <span class="c1"># Entity with the name inside the datastore</span>
        <span class="p p-Indicator">-</span> <span class="p p-Indicator">[</span><span class="nv">name</span><span class="p p-Indicator">:</span> <span class="nv">&lt;string&gt;</span><span class="p p-Indicator">]</span>

          <span class="c1"># And an optional alias (used inside regos)</span>
          <span class="p p-Indicator">[</span><span class="nv">alias</span><span class="p p-Indicator">:</span> <span class="nv">&lt;string&gt; | optional</span><span class="p p-Indicator">]</span>


  <span class="c1"># This example shows how each No-SQL-Datastore should be configured.</span>
  <span class="nt">mongo</span><span class="p">:</span>

    <span class="c1"># Schema name</span>
    <span class="c1"># Because No-SQL-Datastores don&#39;t have concept for schemas, </span>
    <span class="c1"># Kelon ignores the schema name for i.e. a MongoDB.</span>
    <span class="c1">#</span>
    <span class="c1"># !!! The entities inside all schemas of one Datastore have to be disjunct !!!</span>
    <span class="c1"># Otherwise kelon will fail on startup</span>
    <span class="nt">appstore</span><span class="p">:</span>

      <span class="c1"># List of all entities (in case of MongoDB each entity is a collection)</span>
      <span class="nt">entities</span><span class="p">:</span>

        <span class="c1"># Collection with it&#39;s name inside the datastore</span>
        <span class="p p-Indicator">-</span> <span class="p p-Indicator">[</span><span class="nv">name</span><span class="p p-Indicator">:</span> <span class="nv">&lt;string&gt;</span><span class="p p-Indicator">]</span>

          <span class="c1"># Collection&#39;s optinal alias (used inside regos)</span>
          <span class="p p-Indicator">[</span><span class="nv">alias</span><span class="p p-Indicator">:</span> <span class="nv">&lt;string&gt; | optional</span><span class="p p-Indicator">]</span>

          <span class="c1"># Nested entities (Only supported for No-SQL-Datastores)</span>
          <span class="c1"># The depth of nesting entities is unlimited.</span>
          <span class="c1"># It makes no difference if the nested entities are arrays or objects</span>
          <span class="nt">entities</span><span class="p">:</span>

            <span class="c1"># Name of nested entity</span>
            <span class="p p-Indicator">-</span> <span class="p p-Indicator">[</span><span class="nv">name</span><span class="p p-Indicator">:</span> <span class="nv">&lt;string&gt;</span><span class="p p-Indicator">]</span>
              <span class="c1"># Collection&#39;s optinal alias (used inside regos)</span>
              <span class="p p-Indicator">[</span><span class="nv">alias</span><span class="p p-Indicator">:</span> <span class="nv">&lt;string&gt; | optional</span><span class="p p-Indicator">]</span>
</code></pre></div>
<h3 id="connection-options">Connection options</h3>
<p>Kelon supports different databases (PostgreSQL, MySQL and MongoDB) each of them having different connection options.
To keep the configuration of connection options as simple as possible, Kelon just passes all key-value-pairs of each the datastore connection (despite the dedicated ones like i.e. username, host, port, etc.) directly to the used database adapter. Following table should help to lookup all available options for each supported database:</p>
<table>
<thead>
<tr>
<th>Database</th>
<th>Used driver</th>
<th>Options</th>
</tr>
</thead>
<tbody>
<tr>
<td>PostgreSQL</td>
<td>github.com/lib/pq</td>
<td><a href="https://godoc.org/github.com/lib/pq#hdr-Connection_String_Parameters">Go Docs, Connection String Parameters</a></td>
</tr>
<tr>
<td>MySQL</td>
<td>github.com/go-sql-driver/mysql</td>
<td><a href="https://github.com/go-sql-driver/mysql#parameters">Go Docs, DSN Parameters</a></td>
</tr>
<tr>
<td>MongoDB</td>
<td>go.mongodb.org/mongo-driver/mongo</td>
<td><a href="https://docs.mongodb.com/manual/reference/connection-string/#connections-connection-options">Mongo-Docs, Connection options</a></td>
</tr>
</tbody>
</table>
<h3 id="injecting-environment-variables">Injecting environment variables</h3>
<p>Each value inside the datastore.yml file can be replaced with a string follwing the pattern <code>${&lt;environment variable&gt;}</code> which is replaced with the value of the environment variable at startup. </p>
<h2 id="call-operandsdatastore-typeyml">call-operands/{datastore-type}.yml</h2>
<p>Open Policy Agent has <a href="https://www.openpolicyagent.org/docs/latest/policy-language/#operators">builtin call operands</a> which may not be the same as the ones of each datastore.
Therefore each datastore-type has to have a mapping-file inside the folder 'call-operands'. The name of each file inside this directory has to match the type of the datastore.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Call operands map OPA&#39;s functions to datastore-native ones.</span>
<span class="c1"># You find more advanced files in directory /call-operands</span>
<span class="nt">call-operands</span><span class="p">:</span>

  <span class="c1"># Operand name inside OPA&#39;s context</span>
  <span class="p p-Indicator">-</span> <span class="p p-Indicator">[</span><span class="nv">op</span><span class="p p-Indicator">:</span> <span class="nv">&lt;string&gt;</span><span class="p p-Indicator">]</span>

    <span class="c1"># Number of arguments the function call should take</span>
    <span class="c1"># Used for validation</span>
    <span class="p p-Indicator">[</span><span class="nv">args</span><span class="p p-Indicator">:</span> <span class="nv">&lt;int&gt;</span><span class="p p-Indicator">]</span>

    <span class="c1"># Mapping which mappes the OPA-native call to a Datastore-native call.</span>
    <span class="c1"># This is done by defining a pattern where all occurences of $&lt;arg-pos&gt;</span>
    <span class="c1"># are replaced with the original argument at position &lt;arg-pos&gt; (zero based).</span>
    <span class="p p-Indicator">[</span><span class="nv">mapping</span><span class="p p-Indicator">:</span> <span class="nv">&lt;string&gt;</span><span class="p p-Indicator">]</span>
</code></pre></div>
<h2 id="apiyml">api.yml</h2>
<p>The <code>datastore.yml</code> contains all necessary configuration kelon needs to map incoming api-requests to OPA-Queries executed inside datastores.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Mappings for the APIs that your services expose</span>
<span class="nt">apis</span><span class="p">:</span>

  <span class="c1"># API-Collection</span>
  <span class="c1"># Each collection can have a path prefix which is prepended to every API-Mapping</span>
  <span class="c1"># inside the collection.</span>
  <span class="p p-Indicator">-</span> <span class="p p-Indicator">[</span><span class="nv">path-prefix</span><span class="p p-Indicator">:</span> <span class="nv">&lt;URL|string&gt;</span><span class="p p-Indicator">]</span>

    <span class="c1"># All rego-queries mapped by this API-collection will include </span>
    <span class="c1"># this datastore-alias as unknown.</span>
    <span class="c1"># This means that the regos this collection targets can contain</span>
    <span class="c1"># something like &#39;data.&lt;datastore-alias&gt;.&lt;entity&gt;.&lt;attribute&gt;&#39;</span>
    <span class="p p-Indicator">[</span><span class="nv">datastore</span><span class="p p-Indicator">:</span> <span class="nv">&lt;datastore-alias|string&gt;</span><span class="p p-Indicator">]</span>

    <span class="c1"># Path-Mappings for incoming paths</span>
    <span class="c1"># (the most specific mapping is picked in case of multiple mappings)</span>
    <span class="nt">mappings</span><span class="p">:</span>

      <span class="c1"># Path-Mapping</span>
      <span class="c1"># Each mapping has to specify a path (regex) and a package which is used</span>
      <span class="c1"># by kelon to generate the target package of an mapped query.</span>
      <span class="p p-Indicator">-</span> <span class="p p-Indicator">[</span><span class="nv">path</span><span class="p p-Indicator">:</span> <span class="nv">&lt;regex|string&gt;</span><span class="p p-Indicator">]</span> 

        <span class="c1"># OPA&#39;s target package of this Path-Mapping</span>
        <span class="p p-Indicator">[</span><span class="nv">package</span><span class="p p-Indicator">:</span> <span class="nv">&lt;string&gt;</span><span class="p p-Indicator">]</span>

        <span class="c1"># HTTP-Methods this path should map (optional)</span>
        <span class="c1"># If no methods are specified, kellon will match [GET,PUT,POST,DELETE,PATCH]</span>
        <span class="nt">methods</span><span class="p">:</span>
          <span class="p p-Indicator">-</span> <span class="p p-Indicator">[</span><span class="nv">&lt;string&gt; ...</span><span class="p p-Indicator">]</span>
</code></pre></div>
<h2 id="opayml">opa.yml</h2>
<p>Internally used by Open Policy Agent. Klick <a href="https://www.openpolicyagent.org/docs/latest/configuration/">here</a> for more information.</p>
<div class="highlight"><pre><span></span><code><span class="nt">labels</span><span class="p">:</span>
  <span class="nt">app</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Kelon</span>
  <span class="nt">region</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">europe-west3</span>
  <span class="nt">environment</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">development</span>

<span class="nt">decision_logs</span><span class="p">:</span>
  <span class="nt">console</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
  <span class="nt">reporting</span><span class="p">:</span>
    <span class="nt">min_delay_seconds</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">300</span>
    <span class="nt">max_delay_seconds</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">600</span>

<span class="nt">default_decision</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/http/authz/allow</span>
</code></pre></div>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        <a href="../APIs/" class="md-footer__link md-footer__link--prev" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              APIs
            </div>
          </div>
        </a>
      
      
        <a href="../Deployment/" class="md-footer__link md-footer__link--next" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Deployment
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}, "search": "../../assets/javascripts/workers/search.fb4a9340.min.js", "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.a1c7c35e.min.js"></script>
      
    
  </body>
</html>